---
merged:
  commands:
    - set protocols bgp 65536 address-family ipv4-unicast redistribute static metric 50
    - set protocols bgp 65536  neighbor 203.0.113.5 address-family ipv4-unicast allowas-in number 4
    - set protocols bgp 65536  neighbor 203.0.113.5 address-family ipv4-unicast as-override
    - set protocols bgp 65536  neighbor 203.0.113.5 address-family ipv4-unicast attribute-unchanged med
    - set protocols bgp 65536  neighbor 203.0.113.5 address-family ipv6-unicast default-originate route-map map01
    - set protocols bgp 65536 neighbor 203.0.113.5 address-family ipv6-unicast distribute-list export 10
    - set protocols bgp 65536  neighbor 192.0.2.25 address-family ipv4-unicast maximum-prefix 45
    - set protocols bgp 65536  neighbor 192.0.2.25 address-family ipv4-unicast nexthop-self
    - set protocols bgp 65536 neighbor 192.0.2.25 address-family ipv4-unicast route-map export map01
    - set protocols bgp 65536 neighbor 192.0.2.25 address-family ipv4-unicast route-map import map01
    - set protocols bgp 65536  neighbor 192.0.2.25 address-family ipv4-unicast weight 50
  after:
    address_family:
      - afi: "ipv4"
        redistribute:
          - metric: 50
            protocol: "static"
    as_number: 65536
    neighbors:
      - address_family:
          - afi: "ipv4"
            maximum_prefix: 45
            nexthop_self: true
            route_map:
              - action: "export"
                route_map: "map01"
              - action: "import"
                route_map: "map01"
            weight: 50
        neighbor_address: "192.0.2.25"
      - address_family:
          - afi: "ipv4"
            allowas_in: 4
            as_override: true
            attribute_unchanged:
              med: true
          - afi: "ipv6"
            default_originate: "map01"
            distribute_list:
              - acl: 10
                action: "export"
        neighbor_address: "203.0.113.5"

replaced:
  commands:
    - delete protocols bgp 65536  neighbor 203.0.113.5 address-family ipv6-unicast attribute-unchanged
    - delete protocols bgp 65536 address-family ipv4 aggregate-address
    - delete protocols bgp 65536 address-family ipv4 network
    - set protocols bgp 65536 address-family ipv4-unicast redistribute static metric 50
    - set protocols bgp 65536  neighbor 203.0.113.5 address-family ipv4-unicast allowas-in number 4
    - set protocols bgp 65536  neighbor 203.0.113.5 address-family ipv4-unicast as-override
    - set protocols bgp 65536  neighbor 203.0.113.5 address-family ipv4-unicast attribute-unchanged med
    - set protocols bgp 65536  neighbor 203.0.113.5 address-family ipv6-unicast default-originate route-map map01
    - set protocols bgp 65536 neighbor 203.0.113.5 address-family ipv6-unicast distribute-list export 10

overridden:
  commands:
    - delete protocols bgp 65536  neighbor 203.0.113.5 address-family ipv6-unicast attribute-unchanged
    - delete protocols bgp 65536 neighbor 192.0.2.25 address-family
    - delete protocols bgp 65536 address-family ipv6 redistribute
    - delete protocols bgp 65536 address-family ipv4 aggregate-address
    - delete protocols bgp 65536 address-family ipv4 network
    - set protocols bgp 65536 address-family ipv4-unicast redistribute static metric 50
    - set protocols bgp 65536  neighbor 203.0.113.5 address-family ipv4-unicast allowas-in number 4
    - set protocols bgp 65536  neighbor 203.0.113.5 address-family ipv4-unicast as-override
    - set protocols bgp 65536  neighbor 203.0.113.5 address-family ipv4-unicast attribute-unchanged med
    - set protocols bgp 65536  neighbor 203.0.113.5 address-family ipv6-unicast default-originate route-map map01
    - set protocols bgp 65536 neighbor 203.0.113.5 address-family ipv6-unicast distribute-list export 10

deleted:
  commands:
    - delete protocols bgp 65536 address-family ipv4-unicast
    - delete protocols bgp 65536 neighbor 203.0.113.5 address-family
    - delete protocols bgp 65536 neighbor 192.0.2.25 address-family ipv4-unicast

populate:
  config:
    address_family:
      - afi: "ipv4"
        aggregate_address:
          - as_set: true
            prefix: "192.0.2.0/24"
        networks:
          - prefix: "192.1.13.0/24"
            route_map: "map01"
          - backdoor: true
            prefix: "192.2.13.0/24"
      - afi: "ipv6"
        redistribute:
          - metric: 20
            protocol: "ripng"
    as_number: 65536
    neighbors:
      - address_family:
          - afi: "ipv4"
            route_map:
              - action: "export"
                route_map: "map01"
            soft_reconfiguration: true
        neighbor_address: "192.0.2.25"
      - address_family:
          - afi: "ipv6"
            attribute_unchanged:
              next_hop: true
        neighbor_address: "203.0.113.5"
